<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1, user-scalable=no" name="viewport"/>
<!-- Icons & Fonts -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Lato:wght@400;700&amp;family=Poppins:wght@600;700&amp;display=swap" rel="stylesheet"/>
<!-- App Icon -->
<link href="https://drive.google.com/uc?export=view&amp;id=1pT2_mI_B9CrnOde6YK__OzBd2gYEppXy" rel="icon" type="image/png"/>
<title>My Observations App üë∑üèª‚Äç‚ôÇÔ∏è</title>
<!-- Main styles -->
<link href="css/styles.css" rel="stylesheet"/>
</head>
<body class="light-mode">
<div class="app-container">
<!-- HEADER -->
<header class="app-header">
<div class="header-title-area">
<img alt="Safety Group Logo" class="header-logo" src="img/CAT.jpeg"/>
<div class="header-text">
<h1>My Observations App</h1>
<p class="header-subtitle">By Saudi Safety Group</p>
</div>
</div>
<div class="header-actions">
<button aria-label="Open news" class="news-toggle" id="newsToggleButton" type="button">
<i class="fas fa-bullhorn"></i>
</button>
<button aria-label="Toggle dark mode" class="mode-toggle" type="button">
<i class="fas fa-moon" id="modeIcon"></i>
</button>
</div>
</header>
<!-- LEADERBOARD MODAL -->
<div class="modal" id="leaderboardModal">
<div class="modal-content">
<button class="close-btn" onclick="hideLeaderboardModal()" type="button">
                √ó
            </button>
<h2>üèÜ Monthly Leaderboard</h2>
<div id="leaderboardContainer">
<div class="loading-spinner">
<i class="fas fa-spinner fa-spin"></i> Loading leaderboard...
                </div>
</div>
</div>
</div>
<!-- EMERGENCY CONTACTS MODAL -->
<div class="modal" id="emergencyContactsModal">
<div class="modal-content">
<button class="close-btn" onclick="hideEmergencyContactsModal()" type="button">
                √ó
            </button>
<h2>üÜò Emergency Contacts</h2>
<h3>Internal</h3>
<div class="table-scroll">
<table class="emergency-table">
<thead>
<tr>
<th>Name</th>
<th>Designation</th>
<th>Contact No.</th>
</tr>
</thead>
<tbody>
<tr><td>CAT EMERGENCY</td><td>EMERGENCY</td><td><a href="tel:0543133645">054 313 3645</a></td></tr>
<tr><td>HARADH CLINIC</td><td>Haradh Clinic</td><td><a href="tel:0569180911">056 918 0911</a></td></tr>
<tr><td>Maher A. Jardali</td><td>Operation Manager</td><td><a href="tel:0505817134">050 581 7134</a></td></tr>
<tr><td>Rifat Mehmood</td><td>Project Manager</td><td><a href="tel:0505366873">050 536 6873</a></td></tr>
<tr><td>Shahzad Ahmad Khan</td><td>HSSE Manager</td><td><a href="tel:0543133645">054 313 3645</a></td></tr>
<tr><td>Mahmoud Al Cheikh</td><td>Project Engineer</td><td><a href="tel:0551367496">055 136 7496</a></td></tr>
<tr><td>Adnan Ghemrawi</td><td>Project Engineer (Hydrotest)</td><td><a href="tel:0500291404">050 029 1404</a></td></tr>
<tr><td>Hassan El Cherbagi</td><td>Project Engineer</td><td><a href="tel:0539039724">053 903 9724</a></td></tr>
<tr><td>Hadi Hamdi</td><td>Mechanical Engineer</td><td><a href="tel:0508838541">050 883 8541</a></td></tr>
<tr><td>Imad El Hage</td><td>Project PMV Manager</td><td><a href="tel:0553713952">055 371 3952</a></td></tr>
<tr><td>Rabih Hassan</td><td>Sr. Civil Engineer</td><td><a href="tel:0504838832">050 483 8832</a></td></tr>
<tr><td>Om Prakash</td><td>HSSE Coordinator</td><td><a href="tel:0544303677">054 430 3677</a></td></tr>
<tr><td>Tauqeer Nabi</td><td>Environmental Coordinator</td><td><a href="tel:0595820934">059 582 0934</a></td></tr>
<tr><td>Hasan Almarzooq</td><td>HSSE Supervisor</td><td><a href="tel:0592399222">059 239 9222</a></td></tr>
<tr><td>Taha Ghemrawi</td><td>Sr. Transport Officer</td><td><a href="tel:0539195375">053 919 5375</a></td></tr>
<tr><td>Abdul Karim</td><td>Material Supervisor</td><td><a href="tel:0502884442">050 288 4442</a></td></tr>
<tr><td>Arif Khan</td><td>Safety officer/BLS/First Aider</td><td><a href="tel:0576563119">057 656 3119</a></td></tr>
<tr><td>Dr. Shoiab</td><td>CAT Doctor</td><td><a href="tel:0537934638">053 793 4638</a></td></tr>
<tr><td>Romelle M. Pagayon</td><td>Male Nurse</td><td><a href="tel:0531551924">053 155 1924</a></td></tr>
<tr><td>Joe Franco V. Yabut</td><td>CAT First aider</td><td><a href="tel:0506735217">050 673 5217</a></td></tr>
<tr><td>Shahid Bhatti</td><td>Ambulance Driver</td><td><a href="tel:0593886520">059 3886520</a></td></tr>
</tbody>
</table>
</div>
<h3 style="margin-top: 1.5rem;">External</h3>
<div class="table-scroll">
<table class="emergency-table">
<thead>
<tr>
<th>Description</th>
<th>Tel. Numbers</th>
<th>Description</th>
<th>Tel. Numbers</th>
</tr>
</thead>
<tbody>
<tr><td>Southern Area (Abqaiq)</td><td><a href="tel:0135720911">013 572 0911</a></td><td>Civil Defense (Fire)</td><td><a href="tel:998">998</a></td></tr>
<tr><td>Nadec Hospital (Haradh)</td><td><a href="tel:0135849000">013 584 9000</a></td><td>Red Crescent (Ambulance)</td><td><a href="tel:997">997</a></td></tr>
<tr><td>Al Ahsa Hospital (Al Hofuf)</td><td><a href="tel:0135844000">013 584 4000</a></td><td>Local Police</td><td><a href="tel:999">999</a></td></tr>
<tr><td></td><td></td><td>Local Traffic Accident</td><td><a href="tel:993">993</a></td></tr>
</tbody>
</table>
</div>
</div>
</div>
<!-- MAIN CONTENT -->
<main class="content-area">
<!-- HOME TAB -->
<section class="tab-content active" id="HomeTab">
<div class="home-kpi-row">
<div class="home-kpi-card">
<div class="home-kpi-label">Observations Today</div>
<div class="home-kpi-value" id="homeObservationsToday">--</div>
</div>
<div class="home-kpi-card">
<div class="home-kpi-label">Permits Today</div>
<div class="home-kpi-value" id="homePermitsToday">--</div>
</div>
<div class="home-kpi-card">
<div class="home-kpi-label">Talks Today</div>
<div class="home-kpi-value" id="homeTalksToday">--</div>
</div>
</div>
<section class="home-card" id="homeTbtSection">
<header class="home-card-header">
<h3><i class="fas fa-book-open"></i> TBT of The Day</h3>
</header>
<div id="homeTbtContent">
                    Loading TBT of the day...
                </div>
</section>
<p class="month-color-line">
<span class="month-color-label">The Color Code of This Month is:</span>
<span id="colorName">...</span>
</p>
<section class="home-card" id="homeObservationsInsights">
<header class="home-card-header">
<h3><i class="fas fa-chart-pie"></i> This Month ‚Äì Top 5 Areas &amp; Direct Causes</h3>
</header>
<div class="home-insights-grid">
<div class="home-insights-column">
<h4>Top 5 Areas (by observations)</h4>
<ol class="home-insights-list" id="homeTopAreasList">
<li>No data loaded yet.</li>
</ol><div class="home-top-areas-chart-wrapper"><canvas id="homeTopAreasChart"></canvas></div>
</div>
<div class="home-insights-column">
<h4>Top 5 Direct Causes</h4>
<ol class="home-insights-list" id="homeTopDirectCausesList">
<li>No data loaded yet.</li>
</ol><div class="home-top-direct-chart-wrapper"><canvas id="homeTopDirectCausesChart"></canvas></div>
</div>
</div>
</section>
<section class="home-card highlight-card">
<header class="home-card-header">
<h3><i class="fas fa-award"></i> Employee of the Month</h3>
</header>
<div id="employeeOfMonth">Loading...</div>
</section>
<section class="home-card">
<header class="home-card-header">
<h3><i class="fas fa-trophy"></i> Top Best Safety of This Month</h3>
<button class="link-button" onclick="showLeaderboardModal()" type="button">
                        Full leaderboard
                    </button>
</header>
<div id="homeLeaderboardMini">
                    Loading leaderboard...
                </div>
</section>
<button class="accordion accordion-modal" onclick="showLeaderboardModal()" type="button">
<i class="fas fa-trophy"></i> Monthly Leaderboard
            </button>
<button class="accordion accordion-modal" onclick="showEmergencyContactsModal()" type="button">
<i class="fas fa-ambulance"></i> Emergency Contacts
            </button>
<button class="accordion">
<i class="fas fa-exclamation-triangle"></i> EMERGENCY REPORTING PROCEDURES
            </button>
<div class="panel">
<ol>
<li>Dial the emergency number.</li>
<li>Describe the exact location of the emergency.</li>
<li>Describe the nature of the emergency.</li>
<li>Identify the required service and repeat the message.</li>
<li>Answer all questions from the operator.</li>
<li>Do not hang up until instructed.</li>
</ol>
<button class="gps-btn" onclick="getGPSLocation()" type="button">
<i class="fas fa-map-marker-alt"></i>
                    Share My Location (GPS)
                </button>
<div class="gps-result" id="locationResult"></div>
</div>
<button class="accordion">
<i class="fas fa-door-open"></i> EVACUATION TIPS
            </button>
<div class="panel">
<ul>
<li>Stop work and shut down all equipment safely.</li>
<li>Warn nearby personnel and move to assembly area.</li>
<li>Conduct roll call and account for all personnel.</li>
<li>Do not re-enter the area until authorized.</li>
</ul>
</div>
<button class="accordion">
<i class="fas fa-user-shield"></i> Safety Responsibilities
            </button>
<div class="panel">
<ol>
<li>Reporting chain to follow site HSE / Safety supervisor, Coordinator &amp; Manager.</li>
<li>Visibly demonstrate the priority of safety in all activities, including setting a good personal example.</li>
<li>Understand &amp; familiar with safety and health requirements of the contract as well as the CSSP, HIP, JSA, GI‚Äôs, CSM, including local laws and all other best practices.</li>
<li>Conducting all TBTs (Daily, weekly &amp; Mass) with site workers and construction supervisory staff and hand over accurate record to HSE supervisor at the end of each shift.</li>
<li>Conducting frequent HSE inspections of his assigned location and perform continuous monitoring of ongoing activities.</li>
<li>Report all NM, FAI, CA &amp; PA to your immediate HSE supervisor.</li>
<li>Report all incidents that result in injury or damage to property to your immediate HSE supervisor.</li>
<li>Report misuse of equipment, tools, facilities or any other entity to your immediate HSE supervisor.</li>
<li>Report any severe arguments, signs of prejudice, bullying or fighting to your immediate HSE supervisor.</li>
<li>Report any other Health, Safety or Environmental concerns to your immediate HSE supervisor.</li>
<li>Report unsafe situations observed &amp; all unsafe occurrences immediately.</li>
<li>Be vigilant and present at site location all the time while the activities are ongoing for the safe operation.</li>
<li>Responsible and accountable for correct and in time reporting of all HSE issues to assigned HSE supervisor.</li>
<li>Whenever the Safety Officer have concern related to HSE; report this immediately to party in-charge (Foreman, Supervisor or site engineer) no matter what the action will be taken. A report shall be passed to the HSE Supervisor or HSE Coordinator / Manager.</li>
<li>Any mistreated behavior; safety officer shall immediately report and submit a written report to the HSE Supervisor or HSE Coordinator/ Manager.</li>
<li>Fill the observation form clearly and concisely for all unsafe occurrences and get signatures of the activity foreman/supervisor/site engineer and hand over to HSE supervisor.</li>
<li>Maintain accurate records of activities related to H.S.E.</li>
<li>Liaise with Client representatives if instruction given by HSE Supervisor, Coordinator and Manager.</li>
<li>Responsible for monitoring and closure of all site related PSI points, HSE findings/observations raised during audit, inspections or site visits by client/management.</li>
<li>Follow up with construction site supervision about all site HSE issues and concerns for necessary closure.</li>
<li>Providing correctly and accurately filled all necessary checklists which are not limited to (heavy equipment checklist, daily site inspection checklist, portable electric tools etc.)</li>
<li>Inspection and monitoring of all activities of sub-contractors to comply with OHS management system.</li>
<li>Ensure that subcontractors and visitors have received safety orientation prior to enter to the site.</li>
<li>Ensure that all equipment is in a safe working condition, report abnormalities immediately.</li>
<li>Ensure that at no N.D.E. shall be carried out if it may endanger any person.</li>
<li>Ensuring 100% work permit system compliance at site (Client and CAT).</li>
<li>Ensure that equipment operators are competent and possess required valid certificates.</li>
<li>Carry out monthly inspection which are not limited to (fire extinguishers, rigging &amp; lifting equipment etc.)</li>
<li>Ensure that all tools and Electrical Equipment are in good order and do not pose a danger to employees.</li>
<li>Ensure that Scaffolding platform and Ladders are safe, secured, inspected &amp; tagged before use.</li>
<li>Ensure that the jobsite is kept tidy and waste materials are removed at the end of each shift.</li>
<li>Stop work as per HSI 063 and Area Manager Stop Work Authority Policy.</li>
<li>Participate/conduct incident investigations, safety meetings, drills, safety training sessions, etc.</li>
<li>Assist in implementation of waste management plan at project site as well as at camp.</li>
<li>Follow and implement all written/verbal business related instructions given to you from your seniors.</li>
</ol>
</div>
<button class="accordion">
<i class="fas fa-link"></i> Useful Links
            </button>
<div class="panel">
<ul class="links-list">
<li>
<a href="https://drive.google.com/file/d/1JS1VQKXLHdOOFXpYcpRftM-kviBv-TYd/view?usp=sharing" target="_blank">
                            üìò CSM Book
                        </a>
</li>
<li>
<a href="https://drive.google.com/file/d/109vG3Hk3PdgvQF87k0EJ1IiKDTDfdQTv/view?usp=sharing" target="_blank">
                            üìó Saudi Aramco Safety Handbook
                        </a>
</li>
</ul>
</div>
<button class="accordion">
<i class="fa-solid fa-exclamation"></i> About
            </button>
<div class="panel">
<ul class="links-list">
<li> This Application was developed by
                        <a href="https://www.linkedin.com/in/3nzi?utm_source=share&amp;utm_campaign=share_via&amp;utm_content=profile&amp;utm_medium=ios_app">
                            Abdulrahman Alanazi [8222802]
                        </a>
                        under the guidance and support of his supervisor <a href="https://www.linkedin.com/in/abdullah-alkaluf?utm_source=share&amp;utm_campaign=share_via&amp;utm_content=profile&amp;utm_medium=ios_app">
                            Abdullah Alkaluf [8230855]
                        </a>
                         and Other Saudi Safety Officers.
                    </li>
<li> For any Question or Information Catproject404@gmail.com
                        
</li>
</ul>
</div>
</section>
<!-- OBSERVATIONS TAB -->
<section class="tab-content" id="ObservationsTab">
<div class="obs-summary-bar">
<div class="obs-summary-item">
<div class="obs-summary-label" id="obsSummaryLabel">This Month</div>
<div class="obs-summary-value" id="obsCountMonth">--</div>
</div>
<div class="obs-summary-item">
<div class="obs-summary-label">Open</div>
<div class="obs-summary-value" id="obsCountOpen">--</div>
</div>
<div class="obs-summary-item">
<div class="obs-summary-label">Closed</div>
<div class="obs-summary-value" id="obsCountClosed">--</div>
</div>
</div>
<div class="obs-filters">
<div class="obs-filter-row">
<button class="obs-filter-chip" data-range="today">Today</button>
<button class="obs-filter-chip" data-range="week">This Week</button>
<button class="obs-filter-chip active" data-range="month">This Month</button>
<button class="obs-filter-chip" data-range="all">All</button>
</div>
<div class="obs-filter-row">
<select id="obsFilterArea">
<option value="">All Areas</option>
</select>
<select id="obsFilterStatus">
<option value="">All Statuses</option>
<option value="Open">Open</option>
<option value="Closed">Closed</option>
<option value="In Progress">In Progress</option>
</select>
</div>
<div class="obs-filter-row">
<input id="obsSearch" placeholder="Search by location, type, reporter..." type="text"/>
</div>
<div class="obs-filter-row" style="justify-content: center;">
<a class="obs-open-sheet-btn" href="#" id="addObservationButton" target="_blank">
<i class="fas fa-plus-circle"></i>
                        Add New Observation
                    </a>
</div>
</div>
<div id="observationsList"></div>
<button class="obs-open-sheet-btn" id="openSheetButton" type="button">
<i class="fas fa-table"></i>
                Open full data sheet
            </button>
<section aria-label="Observation tips" class="obs-card obs-tips-card">
<header class="obs-tips-header">
<h3><i class="fas fa-lightbulb"></i> Observation Tips</h3>
<p>Quick reminders to help you capture strong, useful safety observations.</p>
</header>
<ul class="obs-tips-list">
<li><span class="tip-title">Be specific</span> ‚Äì describe the exact location, task, and condition you saw.</li>
<li><span class="tip-title">Focus on behaviour &amp; condition</span> ‚Äì what people were doing and what the work area looked like.</li>
<li><span class="tip-title">Link to risk</span> ‚Äì mention what could happen if nothing changes (e.g. slip, fall, dropped object).</li>
<li><span class="tip-title">Record positive safety</span> ‚Äì capture good practices, not only unsafe acts or conditions.</li>
<li><span class="tip-title">Add photos when possible</span> ‚Äì clear images help supervisors understand the issue quickly.</li>
<li><span class="tip-title">Use neutral language</span> ‚Äì describe facts, not personal opinions or blame.</li>
<li><span class="tip-title">Include immediate action</span> ‚Äì note what you or the team did on the spot, if anything.</li>
<li><span class="tip-title">Tag the right area</span> ‚Äì choose the correct area / location to support trending and analysis.</li>
<li><span class="tip-title">Check for repeat issues</span> ‚Äì mention if this is a recurring observation in the same area.</li>
<li><span class="tip-title">Follow up</span> ‚Äì if the risk is high, speak with the supervisor or permit issuer before leaving.</li>
</ul>
</section>
<div class="obs-empty-state" id="observationsEmptyState" style="display: none;">
<i class="fas fa-database"></i>
<p>No observations data loaded yet.</p>
</div>
</section>
<!-- PERMITS TAB -->
<section class="tab-content" id="PermitsTab">
<div class="obs-summary-bar">
<div class="obs-summary-item">
<div class="obs-summary-label">Total Permits</div>
<div class="obs-summary-value" id="permitsCountTotal">--</div>
</div>
<div class="obs-summary-item">
<div class="obs-summary-label">Unique Receivers</div>
<div class="obs-summary-value" id="permitsCountReceivers">--</div>
</div>
<div class="obs-summary-item">
<div class="obs-summary-label" id="permitsSummaryLabel">Today</div>
<div class="obs-summary-value" id="permitsCountToday">--</div>
</div>
</div>
<div class="obs-filters">
<div class="obs-filter-row">
<button class="obs-filter-chip permits-filter-chip active" data-range="today">Today</button>
<button class="obs-filter-chip permits-filter-chip" data-range="week">This Week</button>
<button class="obs-filter-chip permits-filter-chip" data-range="month">This Month</button>
<button class="obs-filter-chip permits-filter-chip" data-range="all">All</button>
</div>
<div class="obs-filter-row">
<select id="permitsAreaFilter">
<option value="">All Areas</option>
</select>
<select id="permitsTypeFilter">
<option value="">All Types</option>
</select>
</div>
<div class="obs-filter-row">
<input id="permitsSearch" placeholder="Search by area, type, receiver, project, permit #..." type="text"/>
</div>
<div class="obs-filter-row" style="justify-content: center;">
<a class="obs-open-sheet-btn" href="https://forms.gle/SNtQRDjAGshRrwBj6" id="addPermitButton" rel="noopener" target="_blank">
<i class="fas fa-plus-circle"></i>
                        Add New Permit
                    </a>
</div>
</div>
<div id="permitsList"></div>
<button class="obs-open-sheet-btn" id="permitsOpenSheetButton" type="button">
<i class="fas fa-table"></i>
                Open full permits sheet
            </button>
<section aria-label="Work permit tips" class="obs-card obs-tips-card permits-tips-card">
<header class="obs-tips-header">
<h3><i class="fas fa-clipboard-check"></i> Work Permit Tips</h3>
<p>Use these checks to improve the quality and safety value of each permit you issue or receive.</p>
</header>
<ul class="obs-tips-list">
<li><span class="tip-title">Verify the scope</span> ‚Äì make sure the permit description matches the real task and location.</li>
<li><span class="tip-title">Check SIMOPS</span> ‚Äì confirm other activities nearby won‚Äôt create conflicting risks.</li>
<li><span class="tip-title">Confirm isolations</span> ‚Äì all mechanical, electrical and process isolations must be applied and tagged.</li>
<li><span class="tip-title">Review the JSA / RA</span> ‚Äì hazards, controls and lifesaving rules must align with the permit scope.</li>
<li><span class="tip-title">Validate PTW training</span> ‚Äì issuer, receiver and key performers should be competent and authorised.</li>
<li><span class="tip-title">Walk the job</span> ‚Äì physically verify the worksite before signing the permit as valid.</li>
<li><span class="tip-title">Check PPE requirements</span> ‚Äì confirm special PPE (e.g. harness, face shield, BA set) is available and used.</li>
<li><span class="tip-title">Control ignition sources</span> ‚Äì for hot work, verify fire watch, gas tests and fire-fighting equipment.</li>
<li><span class="tip-title">Protect line-of-fire zones</span> ‚Äì set up barricades, signage and spotters where required.</li>
<li><span class="tip-title">Confirm emergency arrangements</span> ‚Äì muster point, communication and rescue plan understood by the team.</li>
<li><span class="tip-title">Time &amp; validity</span> ‚Äì ensure the permit duration is realistic and extensions are properly managed.</li>
<li><span class="tip-title">Check interface with other permits</span> ‚Äì lifting, excavation, confined space and hot work permits must be coordinated.</li>
<li><span class="tip-title">Document gas tests</span> ‚Äì record readings, validity time and equipment ID where applicable.</li>
<li><span class="tip-title">Close permits properly</span> ‚Äì verify the worksite is left safe and the permit is signed off by issuer and receiver.</li>
<li><span class="tip-title">Capture learnings</span> ‚Äì note any issues or improvements to discuss in future toolbox talks or audits.</li>
</ul>
</section>
<div class="obs-empty-state" id="permitsEmptyState" style="display: none;">
<i class="fas fa-database"></i>
<p>No permits data loaded yet.</p>
</div>
</section>

<!-- HEAVY EQUIPMENT TAB -->
<section class="tab-content" id="HeavyEquipmentTab">
<div class="obs-summary-bar">
  <div class="obs-summary-item">
    <div class="obs-summary-label">Total Equipment</div>
    <div class="obs-summary-value" id="heqCountTotal">--</div>
  </div>
  <div class="obs-summary-item">
    <div class="obs-summary-label">Valid TPI</div>
    <div class="obs-summary-value" id="heqCountValidTPI">--</div>
  </div>
  <div class="obs-summary-item">
    <div class="obs-summary-label">Expired TPI</div>
    <div class="obs-summary-value" id="heqCountExpiredTPI">--</div>
  </div>
  <div class="obs-summary-item">
    <div class="obs-summary-label">Valid INI</div>
    <div class="obs-summary-value" id="heqCountValidINI">--</div>
  </div>
  <div class="obs-summary-item">
    <div class="obs-summary-label">Expired INI</div>
    <div class="obs-summary-value" id="heqCountExpiredINI">--</div>
  </div>
</div>

<div class="obs-filters">
  <div class="obs-filter-row">
    <select id="heqAreaFilter">
      <option value="">All Yards / Areas</option>
    </select>
    <select id="heqStatusFilter">
      <option value="">All Statuses</option>
      <option value="In Service">In Service</option>
      <option value="Out of Service">Out of Service</option>
    </select>
  </div>

  <div class="obs-filter-row">
    <input
      id="heqSearch"
      type="text"
      placeholder="Search by asset no., type, owner, area..."
    />
  </div>

  <div class="obs-filter-row" style="justify-content: center;">
    <a
      class="obs-open-sheet-btn"
      href="https://forms.gle/DuWuy4dyUfTkiL5t7"
      id="addHeavyEquipmentButton"
      target="_blank"
      rel="noopener"
    >
      <i class="fas fa-plus-circle"></i>
      Add Heavy Equipment
    </a>
  </div>
</div>

<div id="heavyEquipmentList"></div>

<button class="obs-open-sheet-btn" id="heavyOpenSheetButton" type="button">
  <i class="fas fa-table"></i>
  Open full heavy equipment sheet
</button>

<section
  class="obs-card obs-tips-card heavy-equipment-tips-card"
  aria-label="Heavy Equipment safety tips"
>
  <header class="obs-tips-header">
    <h3><i class="fas fa-truck-front"></i> Heavy Equipment Safety Tips</h3>
    <p>
      Use this register to check certificates and plan inspections for cranes,
      forklifts, MEWPs and other plant.
    </p>
  </header>
  <ul class="obs-tips-list">
    <li>
      <span class="tip-title">Verify certification</span> ‚Äì make sure
      third-party inspections are in date before the equipment enters the yard.
    </li>
    <li>
      <span class="tip-title">Check visible defects</span> ‚Äì leaks, damaged
      tyres, cracked hooks, or broken mirrors should be reported before use.
    </li>
    <li>
      <span class="tip-title">Match equipment to task</span> ‚Äì verify load
      charts, reach, and ground conditions are suitable for the planned lift or
      movement.
    </li>
    <li>
      <span class="tip-title">Control access</span> ‚Äì only trained and
      authorised operators should receive keys or access cards.
    </li>
    <li>
      <span class="tip-title">Plan maintenance</span> ‚Äì use the ‚ÄúLast
      Maintenance Date‚Äù to trigger preventive maintenance and avoid unplanned
      breakdowns.
    </li>
  </ul>
</section>

<div class="obs-empty-state" id="heavyEquipmentEmptyState" style="display: none;">
  <i class="fas fa-database"></i>
  <p>No heavy equipment data loaded yet.</p>
</div>
</section>

<!-- TOOLBOX TALK TAB -->
<section class="tab-content" id="ToolboxTab">
<div class="obs-summary-bar">
<div class="obs-summary-item">
<div class="obs-summary-label">Total Talks</div>
<div class="obs-summary-value" id="tbtCountTotal">--</div>
</div>
<div class="obs-summary-item">
<div class="obs-summary-label">Areas Covered</div>
<div class="obs-summary-value" id="tbtCountAreas">--</div>
</div>
<div class="obs-summary-item">
<div class="obs-summary-label">Attendance (Total)</div>
<div class="obs-summary-value" id="tbtCountAttendance">--</div>
</div>
</div>
<div class="obs-filters">
<div class="obs-filter-row">
<button class="obs-filter-chip tbt-filter-chip active" data-range="today">Today</button>
<button class="obs-filter-chip tbt-filter-chip" data-range="week">This Week</button>
<button class="obs-filter-chip tbt-filter-chip" data-range="month">This Month</button>
<button class="obs-filter-chip tbt-filter-chip" data-range="all">All</button>
</div>
<div class="obs-filter-row">
<select id="tbtAreaFilter">
<option value="">All Areas</option>
</select>
</div>
<div class="obs-filter-row">
<input id="tbtSearch" placeholder="Search by area, topic..." type="text"/>
</div>
<div class="obs-filter-row" style="justify-content: center;">
<a class="obs-open-sheet-btn" href="https://forms.gle/8EVSNdjMgitUQL899" id="addTbtButton" rel="noopener noreferrer" target="_blank">
<i class="fas fa-plus-circle"></i>
                        Add New Toolbox Talk
                    </a>
</div>
</div>
<div id="tbtList"></div>
<button class="obs-open-sheet-btn" id="tbtOpenSheetButton" type="button">
<i class="fas fa-table"></i>
                Open full toolbox talks sheet
            </button>
<section aria-label="Toolbox talk tips" class="obs-card obs-tips-card tbt-tips-card">
<header class="obs-tips-header">
<h3><i class="fas fa-chalkboard-teacher"></i> Toolbox Talk Tips</h3>
<p>Use these tips to make toolbox talks short, practical and engaging for the crew.</p>
</header>
<ul class="obs-tips-list">
<li><span class="tip-title">Prepare one clear message</span> ‚Äì decide the single main safety point you want people to remember.</li>
<li><span class="tip-title">Keep it short</span> ‚Äì aim for 5‚Äì10 minutes focused on today‚Äôs work, not a long lecture.</li>
<li><span class="tip-title">Link to real jobs</span> ‚Äì use examples from the actual tasks, permits and JSAs for that shift.</li>
<li><span class="tip-title">Use recent incidents</span> ‚Äì share lessons from near misses or walkthrough findings from your own site.</li>
<li><span class="tip-title">Encourage participation</span> ‚Äì ask open questions instead of talking the whole time.</li>
<li><span class="tip-title">Check understanding</span> ‚Äì ask one or two workers to repeat key controls in their own words.</li>
<li><span class="tip-title">Highlight lifesaving rules</span> ‚Äì connect the topic to relevant lifesaving rules or critical controls.</li>
<li><span class="tip-title">Use simple visuals</span> ‚Äì point at equipment, show a photo or sketch instead of only words.</li>
<li><span class="tip-title">Talk about stop-work authority</span> ‚Äì remind the crew they can stop work if something looks unsafe.</li>
<li><span class="tip-title">Clarify roles</span> ‚Äì explain who is responsible for isolations, supervision, lifting, gas tests, etc.</li>
<li><span class="tip-title">Discuss site-specific risks</span> ‚Äì wind, heat stress, traffic routes, simultaneous operations.</li>
<li><span class="tip-title">Capture attendance correctly</span> ‚Äì make sure everyone signs and write legible badge numbers.</li>
<li><span class="tip-title">Use the local language</span> ‚Äì whenever possible, explain key points in the crew‚Äôs main language.</li>
<li><span class="tip-title">Finish with an action</span> ‚Äì agree one or two concrete things the team will do better today.</li>
<li><span class="tip-title">Close on a positive note</span> ‚Äì recognise good behaviours and thank the team for contributions.</li>
</ul>
</section>
<div class="obs-empty-state" id="tbtEmptyState" style="display: none;">
<i class="fas fa-info-circle"></i>
<p>No toolbox talks found for the selected filters.</p>
</div>
</section>
<!-- TASKS TAB -->
<section class="tab-content" id="TasksTab">
<iframe frameborder="0" id="tasksIframe" marginheight="0" marginwidth="0" title="Daily tasks form">
                Loading‚Ä¶
            </iframe>
</section>
<!-- LIBRARY TAB (chooser + content) -->
<section class="tab-content" id="JSATab">
<!-- First view: chooser with big library blocks -->
<header class="library-intro">
<h2>Safety Library</h2>
<p>Quick access to JSAs, toolbox talks, manuals and walkthrough reports.</p>
</header>
<div class="library-chooser" id="libraryChooser">
<div class="library-choice-card library-card" data-library="jsa">
<div class="library-choice-meta">
<span class="library-chip">JSAs</span>
</div>
<div class="library-choice-main">
<i class="fa-solid fa-book"></i>
<div>
<h3>Job Safety Analysis Library</h3>
<p>Browse JSA documents for high-risk and routine activities.</p>
</div>
</div>
</div>
<div class="library-choice-card library-card" data-library="tbt">
<div class="library-choice-meta">
<span class="library-chip">Talks</span>
</div>
<div class="library-choice-main">
<i class="fas fa-book-open"></i>
<div>
<h3>Tool Box Talk Library</h3>
<p>Browse TBTs for daily safety briefings and refreshers.</p>
</div>
</div>
</div>
<div class="library-choice-card library-card" data-library="csm">
<div class="library-choice-meta">
<span class="library-chip">Standard</span>
</div>
<div class="library-choice-main">
<i class="fa-regular fa-helmet-safety"></i>
<div>
<h3>Construction Safety Manual (CSM)</h3>
<p>Browse CSM chapters, guidelines and procedures.</p>
</div>
</div>
</div>
<div class="library-choice-card library-card" onclick="window.open('https://drive.google.com/file/d/1u9YAc-BggTUomhuF7Hz0-zDZdGFA0Rpt/view', '_blank')">
<div class="library-choice-meta">
<span class="library-chip">Reference</span>
</div>
<div class="library-choice-main">
<i class="fa-solid fa-book-bookmark"></i>
<div>
<h3>Saudi Aramco Safety Handbook</h3>
<p>Open the latest handbook in a new browser tab.</p>
</div>
</div>
</div>
<div class="library-choice-card library-card" data-library="walkthrough">
<div class="library-choice-meta">
<span class="library-chip">Reports</span>
</div>
<div class="library-choice-main">
<i class="fa-solid fa-person-walking"></i>
<div>
<h3>Safety Walkthrough Reports</h3>
<p>Browse area-based safety walkthrough and inspection reports.</p>
</div>
</div>
</div>
</div>
<!-- Second view: actual library (JSA or TBT) -->
<div class="library-content" id="libraryContent" style="display: none;">
<button class="library-back" id="libraryBackButton" type="button">
<i class="fas fa-arrow-left"></i> Back to library menu
                </button>
<h2 class="library-title" id="libraryTitle">
                    Library
                </h2>
<!-- JSA search bar -->
<div class="library-search" id="libraryJsaSearchWrapper" style="display: none;">
<input id="jsaSearch" placeholder="Search JSA titles (e.g., scaffolding, lifting)..." type="text"/>
</div>
<!-- TBT search bar -->
<div class="library-search" id="libraryTbtSearchWrapper" style="display: none;">
<input id="tbtSearch" placeholder="Search TBT titles (e.g., PPE, lifting)..." type="text"/>
</div>
<!-- Lists filled by app.js -->
<div class="library-list" id="jsaListContainer" style="display: none;"></div>
<!-- CSM search bar -->
<div class="library-search" id="libraryCsmSearchWrapper" style="display: none;">
<input id="csmSearch" placeholder="Search CSM titles (e.g., lifting, excavation, PPE)..." type="text"/>
</div>
<!-- Safety Walkthrough search bar -->
<div class="library-search" id="libraryWalkthroughSearchWrapper" style="display: none;">
<input id="walkthroughSearch" placeholder="Search Safety Walkthrough Reports (e.g., yard, area, date)..." type="text"/>
</div>
<div class="library-list" id="tbtLibraryList" style="display: none;"></div>
<!-- Safety Walkthrough list -->
<div class="library-list" id="walkthroughLibraryList" style="display: none;"></div>
<!-- CSM list -->
<div class="library-list" id="csmLibraryList" style="display: none;"></div>
</div>
</section>
<!-- TOOLS TAB -->
<section class="tab-content" id="ToolsTab">
<header class="tools-intro">
<h2>Safety Tools</h2>
<p>Use the risk matrix and environment calculators before issuing permits or planning critical work.</p>
</header>
<div class="tool-toggle-container">
<button class="tool-toggle-btn active-tool" data-tool="risk" type="button">
                    Risk Matrix
                </button>
<button class="tool-toggle-btn" data-tool="heat" type="button">
                    Calculators
                </button>
</div>
<!-- RISK MATRIX CARD -->
<section class="home-card tools-card" id="riskMatrixSection" style="display: none;">
<div class="tools-section-header">
<i class="fas fa-chart-line"></i>
<div>
<h3>Risk Matrix / RA Helper</h3>
<small>Select likelihood &amp; severity to get RA level.</small>
</div>
</div>
<div class="kpi-card risk-matrix-card">
<div class="kpi-input-group">
<label for="riskLikelihood">Likelihood</label>
<select class="kpi-input-field" id="riskLikelihood">
<option value="">Select likelihood</option>
<option value="Rare">Rare</option>
<option value="Unlikely">Unlikely</option>
<option value="Possible">Possible</option>
<option value="Likely">Likely</option>
<option value="Almost Certain">Almost Certain</option>
</select>
</div>
<div class="kpi-input-group">
<label for="riskSeverity">Severity</label>
<select class="kpi-input-field" id="riskSeverity">
<option value="">Select severity</option>
<option value="First Aid">First Aid</option>
<option value="Medical Treatment">Medical Treatment</option>
<option value="Restricted Work / LTI">Restricted Work / LTI</option>
<option value="Permanent Disability">Permanent Disability</option>
<option value="Fatality">Fatality</option>
</select>
</div>
<div class="risk-result-panel">
<div class="risk-result-main">
<div class="risk-score-block">
<div class="risk-result-label">Risk Score</div>
<div class="risk-score-big" id="riskScoreValue">--</div>
</div>
<div class="risk-meta-block">
<div class="risk-level-chip" id="riskLevelLabel">--</div>
<div class="risk-code-pill">
                                    RA Code: <span id="riskCodeValue">--</span>
</div>
</div>
</div>
<p class="risk-guidance-text" id="riskGuidanceText">
                            Select likelihood and severity to see guidance.
                        </p>
</div>
</div>
</section>
<!-- HEAT STRESS CARD -->
<section class="home-card tools-card" id="heatStressSection" style="display: none;">
<div class="tools-section-header heat">
<i class="fas fa-sun"></i>
<div>
<h3>Heat Stress Calculator</h3>
<small>Calculate Heat Index &amp; risk level</small>
</div>
</div>
<div class="kpi-card">
<div class="kpi-input-group">
<label>Air Temperature (¬∞C)</label>
<input class="kpi-input-field" id="inputTemp" oninput="calculateHeatIndex()" placeholder="e.g., 35" type="number"/>
</div>
<div class="kpi-input-group">
<label>Relative Humidity (%)</label>
<input class="kpi-input-field" id="inputHumidity" oninput="calculateHeatIndex()" placeholder="e.g., 40" type="number"/>
</div>
</div>
<div class="result-card" id="heatIndexResultCard">
<div class="result-label">Heat Index</div>
<div class="result-main" id="heatIndexValue">--</div>
<div class="result-tag" id="heatRiskLevel">--</div>
<ul class="result-list" id="heatRecommendationsList">
<li>Enter temperature and humidity to see results.</li>
</ul>
</div>
</section>
<!-- WIND SPEED CARD -->
<section class="home-card tools-card" id="windSpeedSection" style="display: none;">
<div class="tools-section-header wind">
<i class="fas fa-wind"></i>
<div>
<h3>Wind Speed Safety Limits</h3>
<small>Based on crane &amp; man-basket limits</small>
</div>
</div>
<div class="kpi-card">
<div class="kpi-input-group">
<label>Current Wind Speed (km/h)</label>
<input class="kpi-input-field" id="inputWind" oninput="calculateWindSafety()" placeholder="e.g., 25" type="number"/>
</div>
</div>
<div class="result-card" id="windSpeedResultCard">
<div class="result-label">Status</div>
<div class="result-main" id="windValue">--</div>
<div class="result-tag" id="windRiskLevel">--</div>
<ul class="result-list" id="windRecommendationsList">
<li>Enter wind speed to see limits.</li>
</ul>
</div>
</section>
<!-- LIFESAVING RULES CHECKLIST -->
<section class="home-card tools-card" id="lifesavingRulesCard">
<div class="tools-section-header">
<i class="fas fa-heartbeat"></i>
<div>
<h3>Lifesaving Rules Quick Checklist</h3>
<small>Use before starting high-risk work ‚Äì confirm critical controls are in place.</small>
</div>
</div>
<div class="lifesaving-grid">
<div class="lifesaving-item">
<label class="lifesaving-label">
<input class="lifesaving-checkbox" type="checkbox"/>
                            Valid work permit in place
                        </label>
<p class="lifesaving-note">
                            Permit scope, SIMOPS, isolations and duration verified with issuer and receiver.
                        </p>
</div>
<div class="lifesaving-item">
<label class="lifesaving-label">
<input class="lifesaving-checkbox" type="checkbox"/>
                            Energy isolation / LOTO applied
                        </label>
<p class="lifesaving-note">
                            All hazardous energy sources identified, isolated, locked and tested before work.
                        </p>
</div>
<div class="lifesaving-item">
<label class="lifesaving-label">
<input class="lifesaving-checkbox" type="checkbox"/>
                            Working at height protected
                        </label>
<p class="lifesaving-note">
                            Approved access, guardrails or full body harness with lifeline; tools secured against drops.
                        </p>
</div>
<div class="lifesaving-item">
<label class="lifesaving-label">
<input class="lifesaving-checkbox" type="checkbox"/>
                            Lifting &amp; rigging controls in place
                        </label>
<p class="lifesaving-note">
                            Certified lifting plan, competent rigger/signalman, exclusion zone and safe wind limits checked.
                        </p>
</div>
<div class="lifesaving-item">
<label class="lifesaving-label">
<input class="lifesaving-checkbox" type="checkbox"/>
                            Confined space controls in place
                        </label>
<p class="lifesaving-note">
                            Entry permit, gas testing, ventilation, attendant and rescue plan confirmed.
                        </p>
</div>
<div class="lifesaving-item">
<label class="lifesaving-label">
<input class="lifesaving-checkbox" type="checkbox"/>
                            Traffic &amp; line-of-fire risks controlled
                        </label>
<p class="lifesaving-note">
                            Routes separated, spotter in place, no one standing under or between moving loads.
                        </p>
</div>
</div>
<p class="lifesaving-footnote">
                    This is a quick reminder only. Always follow the full Saudi Aramco Lifesaving Rules, CSM and Safety Handbook.
                </p>
</section>
</section>
<!-- NEWS PANEL (opens from header icon) -->
<section aria-hidden="true" class="news-panel" id="NewsPanel">
<div class="news-panel-inner">
<header class="news-panel-header">
<button class="news-back-btn" id="newsBackButton" type="button">
<i class="fas fa-arrow-left"></i>
</button>
<h2>News &amp; Announcements</h2>
</header>
<div class="news-panel-body" id="AnnouncementsContainer">
<div class="loading-spinner" id="newsLoading">
<i class="fas fa-spinner fa-spin"></i> Fetching news...
                    </div>
</div>
</div>
</section>
<!-- üîç Observation detail modal -->
<div class="modal" id="observationDetailModal">
<div class="modal-content">
<button class="close-btn" onclick="hideObservationDetailModal()" type="button">
                    √ó
                </button>
<h2>Observation Details</h2>
<div id="observationDetailBody"></div>
</div>
</div>
<!-- üîç Permit detail modal -->
<div class="modal" id="permitDetailModal">
<div class="modal-content">
<button class="close-btn" onclick="hidePermitDetailModal()" type="button">
                    √ó
                </button>
<h2>Work Permit Details</h2>
<div id="permitDetailBody"></div>
</div>
</div>

<!-- üöú Heavy Equipment detail modal -->
<div class="modal" id="heavyEquipmentDetailModal">
<div class="modal-content">
<button class="close-btn" onclick="hideHeavyEquipmentDetailModal()" type="button">
                    √ó
                </button>
<h2>Heavy Equipment Details</h2>
<div id="heavyEquipmentDetailBody"></div>
</div>
</div>

<!-- üß∞ Toolbox Talk detail modal -->
<div class="modal" id="toolboxDetailModal">
<div class="modal-content">
<button class="close-btn" onclick="hideToolboxDetailModal()" type="button">
                    √ó
                </button>
<h2>Toolbox Talk Details</h2>
<div id="toolboxDetailBody"></div>
</div>
</div>
</main>
<!-- FLOATING BUTTONS -->
<button class="daily-tasks-btn" id="dailyTasksButton" title="Daily Tasks" type="button">
<i class="fas fa-list-check"></i> Daily Tasks
    </button>
<button id="emergencyQuickButton" onclick="showEmergencyContactsModal()" title="Emergency Contacts" type="button">
<i class="fas fa-ambulance"></i>
</button>
<!-- NAV BAR -->
<nav class="nav-bar" role="tablist">
<button aria-selected="true" class="nav-button active" data-tab="HomeTab" type="button">
<span class="nav-icon"><i class="fas fa-house"></i></span>
<span>Home</span>
</button>
<button class="nav-button" data-tab="ObservationsTab" type="button">
<span class="nav-icon"><i class="fas fa-chart-line"></i></span>
<span>Observations</span>
</button>
<button class="nav-button" data-tab="PermitsTab" type="button">
<span class="nav-icon"><i class="fas fa-id-card-clip"></i></span>
<span>Permits</span>
</button>
<button class="nav-button" data-tab="HeavyEquipmentTab" type="button">
<span class="nav-icon"><i class="fas fa-truck-front"></i></span>
<span>Heavy Equip.</span>
</button>
<button class="nav-button" data-tab="ToolboxTab" type="button">
<span class="nav-icon"><i class="fas fa-chalkboard-teacher"></i></span>
<span>Toolbox Talk</span>
</button>
<button class="nav-button" data-tab="JSATab" type="button">
<span class="nav-icon"><i class="fas fa-handshake"></i></span>
<span>Library</span>
</button>
<button class="nav-button" data-tab="ToolsTab" type="button">
<span class="nav-icon"><i class="fas fa-calculator"></i></span>
<span>Tools</span>
</button>
</nav>
</div>
<!-- SCRIPTS -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script><script src="js/data.js"></script>
<script src="js/app.js"></script>
</body>
</html>
